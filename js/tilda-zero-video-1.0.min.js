function t396_initVideo(e){var t=e.querySelector(".tn-atom__videoiframe"),a=e.querySelector(".tn-atom");if(a&&t&&!t.querySelector("iframe, video")){a.style.backgroundColor="#000";var o=document.getElementById("allrecords"),i=e?e.closest(".r"):null,r={recid:i?i.id.replace("rec",""):"",elementID:e.getAttribute("data-elem-id")||"",hasCover:"y"===a.getAttribute("data-atom-video-has-cover"),hasAutoplay:"y"===t396_elem__getFieldValue(e,"autoplay"),hasInfo:"y"===t396_elem__getFieldValue(e,"showinfo"),hasLoop:"y"===t396_elem__getFieldValue(e,"loop"),isMuted:"y"===t396_elem__getFieldValue(e,"mute"),startSec:t396_elem__getFieldValue(e,"startsec")||"",endSec:t396_elem__getFieldValue(e,"endsec")||"",vimeoHash:t.getAttribute("data-vimeohash")||"",hiddenControls:"hidden"===t.getAttribute("data-video-controls"),isCoverFit:"cover"===t.getAttribute("data-video-object-fit"),isEditMode:!!o&&"edit"===o.getAttribute("data-tilda-mode"),isLazy:"y"===window.lazy},d,s="",n;document.createElement("script").textContent='lazyload_iframe = new LazyLoad({elements_selector: ".t-iframe"});';var l=t.getAttribute("data-youtubeid"),u=t.getAttribute("data-vimeoid"),c=t.getAttribute("data-mp4video"),v=t.getAttribute("data-vkvideoid"),_=t.getAttribute("data-rutubeid"),m=t.getAttribute("data-kinescopeid"),p=t.getAttribute("data-webmvideo"),y=t.getAttribute("data-iframevideo");if(l&&(s=t396_video__generateIframeSrc(l,r,"youtube"),d=t396_video__createIframe(s,r,"youtube"),r.isLazy||d.addEventListener("load",(function(){a.style.backgroundColor=""}))),u&&(s=t396_video__generateIframeSrc(u,r,"vimeo"),d=t396_video__createIframe(s,r,"vimeo")),v&&(s=t396_video__generateIframeSrc(v,r,"vkvideo"),d=t396_video__createIframe(s,r,"vkvideo")),_&&(s=t396_video__generateIframeSrc(_,r,"rutube"),d=t396_video__createIframe(s,r,"rutube")),m&&(s=t396_video__generateIframeSrc(m,r,"kinescope"),d=t396_video__createIframe(s,r,"kinescope")),y&&(d=t396_video__createIframe(s=y,r,"iframe")),c||p){var f=c||p;r.type="webm",c&&(r.type="mp4"),r.hasCover&&(r.isCoverFit=!0),d=t396_video__createVideoHTML(f,r);var h="display: flex; align-items: center;height:100%;";r.isCoverFit&&(h+="position: relative;"),t.style.cssText=h}if(r.hasCover)a.addEventListener("click",(function(){if(!a.querySelector("iframe, video")){d&&t.appendChild(d),a.style.backgroundImage="none";var e=a.querySelector(".tn-atom__video-play-link");e&&(e.style.display="none"),(c||p)&&d&&!a.processVideo&&(d.play(),a.processVideo=!0)}}));else if(d&&t.appendChild(d),l&&r.isLazy&&t396_video__processYoutubeIframeBgOnLoad(a,d),c||p){var b=t.querySelector("video");t396_video__setLoaderForHTMLVideo(a,b,r.isCoverFit),t396_video__lazyLoadProcessHTMLVideo(b,r),b&&!r.isEditMode&&r.hiddenControls&&!r.hasAutoplay&&b.addEventListener("click",(function(){b.readyState<2||(b.paused?b.play():b.pause())}))}}}function t396_video__processYoutubeIframeBgOnLoad(e,t){if(t&&e&&"MutationObserver"in window){var a=new MutationObserver((function(o){o.forEach((function(o){"attributes"===o.type&&"src"===o.attributeName&&o.target.src&&t.addEventListener("load",(function(){e.style.backgroundColor="",a.disconnect()}))}))}));a.observe(t,{attributes:!0})}}function t396_video__generateIframeSrc(e,t,a){var o,i={youtube:"https://www.youtube.com/embed/",vimeo:"//player.vimeo.com/video/",vkvideo:"https://vk.com/video_ext.php",rutube:"https://rutube.ru/play/embed/",kinescope:"https://kinescope.io/embed/"}[a],r=i+e+"?";if("youtube"===a&&(t.hasInfo&&(r+="&showinfo=1"),t.hasLoop&&(r+="&loop=1&playlist="+e),t.startSec>0&&(r+="&start="+t.startSec),t.endSec>0&&(r+="&end="+t.endSec),t.isMuted&&(r+="&mute=1"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=1",t.hasCover&&(r+="&amp;rel=0")),r+="&enablejsapi=1"),"vimeo"===a&&(r+="color=ffffff&badge=0",t.vimeoHash&&(t.vimeoHash=t.vimeoHash.trim(),r+=t.vimeoHash?"&h="+t.vimeoHash+"&":""),t.hasInfo?r+="&title=1&byline=1&portrait=1":r+="&title=0&byline=0&portrait=0",t.startSec>0&&(r+="#t="+t.startSec+"s"),t.endSec>0&&(r+="&end="+t.endSec+"s"),t.hasLoop&&(r+="&loop=1"),t.isMuted&&(r+="&muted=1"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=1",r+="&autopause=false"),r+="&api=1"),"vkvideo"===a){var d=e.split("_"),s=d[0],n=d[1],l=d[2];r=i+"?oid="+s+"&id="+n+"&color=ffffff1&hd=2",l&&(r+="&hash="+l),t.startSec>0&&(r+="&t="+t.startSec+"s"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=1"),r+="&js_api=1"}return"rutube"===a&&(e.includes("?p=")&&(r=i+e),t.startSec>0&&(r+="&t="+t.startSec)),"kinescope"===a&&(t.startSec>0&&(r+="&t="+t.startSec),t.isMuted&&(r+="&muted=true"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=true",r+="&autopause=false"),t.hasLoop&&(r+="&loop=true")),r}function t396_video__createIframe(e,t,a){var o=document.createElement("iframe"),i=a;return i+="-iframe-"+t.recid+"-"+t.elementID,o.id=i,o.width="100%",o.height="100%",o.frameBorder="0",o.allowFullscreen=!0,o.allow="autoplay; encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;",!t.hasCover&&t.isLazy?(o.classList.add("t-iframe"),o.setAttribute("data-original",e)):o.src=e,t.hasCover&&(o.allow="autoplay"),o}function t396_video__createVideoHTML(e,t){var a=window.t396__isMobile&&window.isSafari&&!t.hasCover?"#t=0.001":"",o=e?'<source src="'+e+a+'" type="video/'+t.type+'">':"",i=document.createElement("video");return i.style.cssText="width: 100%;"+(t.hasCover?"":"display:none;")+(t.isCoverFit?"height: 100%; object-fit: cover; position: absolute;":"")+(t.hiddenControls&&!t.hasAutoplay?"cursor: pointer;":""),i.id="html-video-"+t.recid+"-"+t.elementID,i.innerHTML=o,t.hiddenControls||(i.controls=!0),!t.isEditMode&&t.hasAutoplay&&(i.autoplay=!0),t.isMuted&&(i.muted=!0),i.playsInline=!0,t.hasLoop&&(i.loop=!0),i}function t396_video__lazyLoadProcessHTMLVideo(e,t){var a;t.hasAutoplay&&!t.isEditMode&&e&&"IntersectionObserver"in window&&new IntersectionObserver((function(e){e.forEach((function(e){var t=e.target,a=function o(){t.removeEventListener("loadeddata",a),e.isIntersecting?t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA&&t.play():t.pause()};t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?a():t.addEventListener("loadeddata",a)}))})).observe(e)}function t396_video__setLoaderForHTMLVideo(e,t,a){if(t){var o=/iPhone|iPad|iPod/i.test(navigator.userAgent)||"ontouchend"in document&&/Macintosh/.test(navigator.userAgent),i='background-image: url("https://tilda.ws/img/spinner-white.gif");';i+="background-repeat: no-repeat; background-position: center;",e.style.cssText+=i,t.addEventListener(o?"loadedmetadata":"canplay",(function(){e.style.backgroundImage="",a&&(e.style.backgroundColor=""),t.style.display="block"}))}}
